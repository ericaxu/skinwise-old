@(state: src.controllers.util.ResponseState, product: src.models.data.Product)

@template(product.getBrand.getName + " " + product.getName + " - Skin Wise", state) {

} {

<div class="product_detail">
    <div class="picture">
        <img src="/assets/images/COOLA_Tinted Matte_SPF_30_for_Face.jpg" alt="COOLA Tinted Matte SPF 30 for Face"/>
    </div>

    <div class="ingredient_container">
        <h1 class="name">@product.getBrandName @product.getName</h1>
        @if(product.hasDescription) {
            <div class="claim">
                <h3>What It Does</h3>
                <p>@product.getDescription</p>
            </div>
        }

        @if(!product.getKey_ingredients.isEmpty) {
            <div class="active_ingredients">
                <h3>Key Ingredients</h3>
                @defining(product.getKey_ingredients) { key =>
                    <p>@for(i <- 0 to key.length-2) {
                        @if(key(i).getIngredient != null) {
                            <span class="ingredient" data-id="@key(i).getIngredient.getId">@key(i).getDisplayName</span>,
                        } else {
                            <span class="ingredient unrecognized">@key(i).getDisplayName</span>,
                        }
                    }

                    @if(key(key.length-1).getIngredient != null) {
                        <span class="ingredient" data-id="@key(key.length-1).getIngredient.getId">@key(key.length-1).getDisplayName</span>
                    } else {
                        <span class="ingredient unrecognized">@key(key.length-1).getDisplayName</span>
                    }
                    </p>
                }
            </div>

            @if(!product.getIngredients.isEmpty) {
                <div class="other_ingredients">
                    <h3>Other Ingredients</h3>
            }
        } else {
            @if(!product.getIngredients.isEmpty) {
                <div class="ingredients">
                    <h3>Ingredients</h3>
            }
        }

        @if(!product.getIngredients.isEmpty) {
            @defining(product.getIngredients) { ing =>
                <p>@for(i <- 0 to ing.length-2) {
                    @if(ing(i).getIngredient != null) {
                        <span class="ingredient" data-id="@ing(i).getIngredient.getId">@ing(i).getDisplayName</span>,
                    } else {
                        <span class="ingredient unrecognized">@ing(i).getDisplayName</span>,
                    }
                }

                @if(ing(ing.length-1).getIngredient != null) {
                    <span class="ingredient" data-id="@ing(ing.length-1).getIngredient.getId">@ing(ing.length-1).getDisplayName</span>
                } else {
                    <span class="ingredient unrecognized">@ing(ing.length-1).getDisplayName</span>
                }
                </p>
            }
        }
        </div>
    </div>
</div>

} {

<script>
    postToAPI('/product/ingredientinfo', {
        id: @product.getId
    }, getIngredientInfoSuccess);
</script>

}
